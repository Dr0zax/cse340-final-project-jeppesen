<%- include('../../partials/header') %>
    <h1><%= title %></h1>

    <% if (responses && responses.length > 0) { %>
        <div class="review-responses">
            <% responses.forEach(response => { %>
                <div class="response-item">
                    <h3 class="response-vehicle"><a href="/catalog/<%= response.vehicle_slug %>"><%= response.vehicle_name %></a></h3>
                    <p class="response-comment"><span class="response-user"><%= response.user_name %> - </span><%= response.comment %></p>
                    <p class="response-rating"><%= response.rating %> / 5</p>
                    <p class="response-date">Submitted: <%= new Date(response.created_at).toLocaleDateString() %></p>
                    <% if (loggedIn) { %>
                        <% if (currentUser.role_name == "owner" || currentUser.role_name == "employee" || currentUser.id === response.user_id) { %>
                            <div class="actions-panel">
                                <a href="/review/edit/<%= response.id %>" class="response-edit">Edit</a>
                                <form action="/review/<%= response.id %>/delete" method="POST" onsubmit="return confirm('Are you sure you want to delete your review? This action cannot be undone.');">
                                    <button class="delete-button" type="submit">Delete</button>
                                </form>
                            </div>
                        <% } %>  
                    <% } %>  
                </div>

            <% }); %>
        </div>
    <% } else { %>
        <p class="no-responses">No contact form submissions yet.</p>
    <% } %>
<%- include('../../partials/footer') %>